{"id":"niri-letterbox-2gh","title":"Feature: CLI flag to create config file if it doesn't exist","description":"Add a CLI flag (e.g., --create or --init) that creates the config file with just the letterboxing configuration if it doesn't exist.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-03T23:44:47.031741566-05:00","created_by":"rektide","updated_at":"2026-01-03T23:44:47.031741566-05:00"}
{"id":"niri-letterbox-3xk","title":"Feature: XDG config directory support","description":"Integrate XDG config directory support to find niri config files in the appropriate locations (e.g., ~/.config/niri/config.kdl). Use a sindre sorhus package for this.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-03T23:44:47.036151505-05:00","created_by":"rektide","updated_at":"2026-01-04T00:59:05.096856596-05:00","closed_at":"2026-01-04T00:59:05.096856596-05:00","close_reason":"Implemented XDG config directory support using sindresorhus/xdg-basedir package. Created src/config.ts with getNiriConfigPath() and getNiriConfigDir() functions. Successfully resolves to ~/.config/niri/config.kdl by default, supports custom paths."}
{"id":"niri-letterbox-5wq","title":"Evaluate KDL libraries for TypeScript","description":"Evaluate KDL libraries for TypeScript to parse niri's config.kdl files. Research identified three main options:\n\n**Top Recommendation: @bgotink/kdl**\n- 24 GitHub stars, latest version 0.4.0 (Nov 2025)\n- Format-preserving parser that maintains comments and whitespace\n- Native TypeScript with full type definitions\n- Best for config files that humans maintain\n\n**Alternative: kdljs (official)**\n- 147 GitHub stars, latest version 0.3.0 (Jan 2025)\n- Official KDL implementation with querying support (KQL)\n- Good for complex queries but less format-preserving\n\n**Decision: Evaluate @bgotink/kdl first** due to its format-preserving capabilities which are critical for config files. Test the library by:\n1. Installing the package\n2. Reading a sample niri config.kdl file\n3. Parsing and accessing nodes\n4. Testing modification and re-formatting to ensure preservation\n\nIf @bgotink/kdl works well, proceed with using it. If issues arise, fall back to kdljs.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-04T00:35:55.695968758-05:00","created_by":"rektide","updated_at":"2026-01-04T00:36:53.196218569-05:00","closed_at":"2026-01-04T00:36:53.196218569-05:00","close_reason":"Successfully installed and tested @bgotink/kdl package. The library correctly parses KDL files, preserves formatting and comments, and can format parsed structures back to KDL. Ready to use for reading niri's config.kdl files."}
{"id":"niri-letterbox-7gx","title":"Feature: Struts size control for letterboxing","description":"Implement struts size control for niri letterboxing. Add a CLI argument to control the size of the struts as a percentage. Struts shrink the area occupied by windows, effectively creating letterboxing gaps at top and bottom.\n\nPercentage logic:\n- 0% = no struts (no letterboxing, full display area)\n- 100% = struts top and bottom are both half of output height (maximum letterboxing, thin center line)\n\nThis will modify the `struts { top X bottom X }` values in the niri config file (or include file) based on the output height.","status":"open","priority":1,"issue_type":"feature","created_at":"2026-01-04T01:52:09.704120928-05:00","created_by":"rektide","updated_at":"2026-01-04T05:24:44.627521383-05:00"}
{"id":"niri-letterbox-8hz","title":"Feature: Support config.kdl and alternative config file paths","description":"Work with niri's config.kdl by default, but allow specifying alternative config file paths to work on.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-03T23:44:47.033561706-05:00","created_by":"rektide","updated_at":"2026-01-03T23:44:47.033561706-05:00"}
{"id":"niri-letterbox-8zz","title":"Feature: Automatic backup system with datestamped versions","description":"Implement backup system that creates datestamped backups before modifying config.kdl in place. Should support:\n- Automatic backup before any modification\n- Datestamped filenames\n- Configurable backup subdirectory","status":"open","priority":1,"issue_type":"feature","created_at":"2026-01-03T23:44:47.035142129-05:00","created_by":"rektide","updated_at":"2026-01-03T23:44:47.035142129-05:00"}
{"id":"niri-letterbox-9pk","title":"Feature: Add --output flag to select target monitor","description":"Add --output flag to select specific monitor for letterboxing. This flag is needed to calculate absolute strut values since struts are based on percentages of output height.\n\nImplementation:\n1. Add --output/-o CLI argument to accept output name (e.g., \"DP-1\", \"HDMI-A-1\")\n2. Query niri to get output dimensions for the specified monitor (resolution: width x height)\n3. Use the output's height to calculate absolute strut values from percentage\n4. Apply struts to that specific output (if per-output struts are supported) or all outputs if global\n\nIf output not specified, use the primary/focused output or prompt user to select one.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-04T05:25:01.064927586-05:00","created_by":"rektide","updated_at":"2026-01-04T05:25:01.064927586-05:00"}
{"id":"niri-letterbox-9vp","title":"Feature: Implement letterboxing with gap size and position controls","description":"Create CLI to adjust display letterboxing with two percentage controls:\n1. Gap size % (10%, 20%, 99% = thin squeezed line)\n2. Position % (50% = middle, 0% = bottom, 100% = top)\n\nThis should be a general solution that works on the configured display output.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-03T23:44:47.032087434-05:00","created_by":"rektide","updated_at":"2026-01-04T01:52:14.0143952-05:00","closed_at":"2026-01-04T01:52:14.0143952-05:00","close_reason":"Split into two separate tasks for better tracking: gap size control (niri-letterbox-7gx) and position control (niri-letterbox-qle)."}
{"id":"niri-letterbox-dpg","title":"Research: Understand niri output display naming and identification","description":"Research complete on niri output display naming and identification. Key findings:\n\n**Research performed via show-config command analysis:**\n\n**Output naming convention:**\n- Outputs use DRM connector names (Direct Rendering Manager standard)\n- Examples: \"DP-1\", \"DP-3\", \"HDMI-A-1\", \"eDP-1\"\n- Names are string identifiers wrapped in quotes in config: `output \"DP-1\" { ... }`\n\n**Output configuration options:**\n- `mode`: Resolution and refresh rate (e.g., \"2560x1440@100.000\")\n- `position`: X,Y coordinates for output placement (e.g., \"x=1280 y=0\")\n- `variable-refresh-rate`: on-demand or always\n- `focus-at-startup`: Boolean flag\n- `off`: Disable output entirely\n\n**How to identify outputs:**\n- Run `niri msg outputs` while niri is running to list all outputs\n- Output names are consistent across sessions (hardware-based)\n\n**CLI query needed:**\nFor the `--output` flag (`niri-letterbox-9pk`), we need to run niri command to:\n1. List all available outputs\n2. Get output dimensions (width x height)\n3. Allow user to select by name\n\n**Implication for letterboxing:**\nOutput naming is well-defined, making it straightforward to target specific monitors for percentage-based strut calculations.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T23:44:55.725591372-05:00","created_by":"rektide","updated_at":"2026-01-04T05:30:49.259336315-05:00","closed_at":"2026-01-04T05:30:49.259336315-05:00","close_reason":"Completed"}
{"id":"niri-letterbox-jkg","title":"Create show-config subcommand to read current niri configuration","description":"Create a read-config subcommand that reads and displays the current niri configuration file. This is the first step to understand the config format and prepare for modifications.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-04T00:29:41.068596015-05:00","created_by":"rektide","updated_at":"2026-01-04T01:14:41.553367457-05:00","closed_at":"2026-01-04T01:14:41.553367457-05:00","close_reason":"Implemented show-config subcommand using Gunshi CLI framework. Subcommand successfully reads and displays niri configuration from XDG config directory (~/.config/niri/config.kdl). Works with both existing and missing config files (displays appropriate error message)."}
{"id":"niri-letterbox-kw9","title":"Feature: Dry run mode","description":"Add a --dry-run flag that shows what changes would be made without actually modifying the config file.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-03T23:44:47.034036402-05:00","created_by":"rektide","updated_at":"2026-01-03T23:44:47.034036402-05:00"}
{"id":"niri-letterbox-osw","title":"Research: Understand niri config.kdl format and display configuration","description":"Research complete on niri config.kdl format and display configuration. Key findings:\n\n**Research performed via show-config command analysis:**\n\n**Struts for letterboxing:**\n- Struts are defined in global `layout { struts { ... } }` section\n- Options: left, right, top, bottom (all in logical pixels)\n- Struts shrink the area occupied by windows, creating outer gaps\n- Top and bottom struts add outer gaps (perfect for letterboxing)\n- **Critical finding: Struts are GLOBAL, not per-output** - they apply to all outputs simultaneously\n\n**Output configuration:**\n- Each output defined separately: `output \"DP-1\" { mode \"3840x2160@119.880\" position x=1280 y=0 }`\n- Contains: mode (resolution+refresh), position (x,y), variable-refresh-rate, off flag\n- Output naming: standard DRM connector names (DP-1, HDMI-A-1, etc.)\n\n**Layout section:**\n- Contains: gaps (inner window gaps), struts (outer gaps), focus-ring, border, preset-column-widths\n- Focus ring and border control window decorations (solid background behind windows)\n\n**Implications for letterboxing:**\n- Struts can only be global, affecting all monitors simultaneously\n- Per-output targeting (`niri-letterbox-uw4`) may not be possible with struts alone\n- May need alternative approach (output position adjustments, or per-output struts if supported in newer niri versions)\n\n**Include files:**\n- KDL format supports include statements (not currently in our config)\n- Include files would be the clean approach for modular letterboxing config","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T23:44:55.724613984-05:00","created_by":"rektide","updated_at":"2026-01-04T05:30:49.248913292-05:00","closed_at":"2026-01-04T05:30:49.248913292-05:00","close_reason":"Completed"}
{"id":"niri-letterbox-qle","title":"Feature: Strut offset control for letterboxing","description":"Implement strut offset control for niri letterboxing. Add a CLI argument to control vertical offset of the display area within struts as a percentage.\n\nStrut offset logic:\n- +100% = all strut percentage allocated to top (display area pushed to bottom)\n- 0% = struts are equal top and bottom (display area centered)\n- -100% = all strut percentage allocated to bottom (display area pushed to top)\n\nThis determines how strut percentage is distributed between top and bottom struts, effectively moving the display area up or down within the letterboxing gaps.","status":"open","priority":1,"issue_type":"feature","created_at":"2026-01-04T01:52:09.713484773-05:00","created_by":"rektide","updated_at":"2026-01-04T05:26:38.073830757-05:00"}
{"id":"niri-letterbox-t5t","title":"Task: Write config to include file with proper inclusion in main config","description":"Research and implement writing letterboxing configuration to a separate include file instead of modifying the main niri config.kdl. This needs to:\n\n1. Research how to create include files in niri config.kdl (likely using 'include' or 'mod' statements)\n2. Ensure the include file is properly referenced from the main niri config.kdl\n3. Determine best practices for include file naming and location\n4. Test that the include file is correctly loaded by niri\n\nBenefits:\n- Keeps main config.kdl clean and focused\n- Makes letterboxing configuration modular and easy to disable\n- Easier to manage letterboxing settings separately","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-04T05:21:05.466761226-05:00","created_by":"rektide","updated_at":"2026-01-04T05:21:05.466761226-05:00"}
{"id":"niri-letterbox-uw4","title":"Feature: Constrain letterboxing to single output/monitor (may not be possible)","description":"Add ability to specify which output/monitor to apply letterboxing to, rather than affecting all displays.\n\n**WARNING: Feature may not be achievable**\n\nBased on research in `niri-letterbox-osw`, niri's struts are defined in the global `layout` section and apply to ALL outputs simultaneously. Struts cannot be configured per-output.\n\n**Potential approaches:**\n1. Per-output struts (if supported in newer niri versions - requires verification)\n2. Alternative: Use output `position` adjustments to shift content off-letterboxed displays\n3. Alternative: Different include file per output (requires multiple include statements in main config)\n\n**Dependencies:**\n- Requires verification of niri's per-output capabilities\n- May need alternative implementation if struts remain global-only","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-03T23:44:47.033160754-05:00","created_by":"rektide","updated_at":"2026-01-04T05:30:59.827875336-05:00"}
{"id":"niri-letterbox-vdh","title":"Research: Investigate sindre sorhus XDG config packages","description":"Research complete on sindre sorhus XDG config packages. Key findings:\n\n**Research performed:**\nSearched npm for sindre sorhus XDG packages and evaluated options.\n\n**Selected package: xdg-basedir**\n- Package name: `xdg-basedir`\n- Author: sindresorhus\n- Version installed: 5.1.0\n- Last updated: Aug 2021\n- Features:\n  - Exports: `xdgConfig`, `xdgData`, `xdgState`, `xdgCache`, `xdgRuntime`\n  - Exports: `xdgConfigDirectories`, `xdgDataDirectories`\n- Trust level: Sindre's packages are well-maintained and industry-standard\n\n**Implementation in project:**\n- Created `src/config.ts` with `getNiriConfigPath()` and `getNiriConfigDir()` functions\n- Uses `xdgConfigDirectories[0]` to get primary XDG config directory\n- Resolves to `~/.config/` on Linux systems\n- Appends `/niri/config.kdl` for niri config path\n- Tested successfully: returns `/home/rektide/.config/niri/config.kdl`\n\n**Alternative considered:**\n- `xdg-portable` by rivy - cross-platform but not sindre sorhus\n\n**Decision:** xdg-basedir is appropriate choice - it's from sindre sorhus ecosystem, simple, and meets project requirements.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T23:44:55.723979974-05:00","created_by":"rektide","updated_at":"2026-01-04T05:30:49.157871422-05:00","closed_at":"2026-01-04T05:30:49.157871422-05:00","close_reason":"Completed"}
{"id":"niri-letterbox-yj9","title":"Setup: Initialize project with base packages and tooling","description":"Set up the project with all necessary packages and development tooling including gunshi for CLI, TypeScript tooling (tsdown, @typescript/native-preview), code quality tools (oxfmt, oxlint), and XDG config dir support.","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-03T23:44:47.017399257-05:00","created_by":"rektide","updated_at":"2026-01-04T00:08:11.969369945-05:00","closed_at":"2026-01-04T00:08:11.969369945-05:00","close_reason":"Completed"}
